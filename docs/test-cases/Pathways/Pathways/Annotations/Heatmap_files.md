#Annotations with heatmap files

Test verifies
- applying colorization to Pathway's map nodes using a heatmap files, previously registered in NGB 

**Prerequisites**:
1. Go to NGB
2. Close **PATHWAYS** panel if it is opened

dataset = **SV_Sample1**, heatmap = **pathway-annotation3.tsv**
```
Gene    Tetm    Tetp
Tetm    0.55    0.98
Tetp    0.04    1.0
Laclm       0.45
Clp 0.29        
```

| Steps | Actions                                                          | Expected results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|-------|------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1     | Login to NGB                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 2     | Go to DATASETS panel                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 3     | Select **pathway-annotation3** dataset in **SV_Sample1** dataset |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 4     | Open **PATHWAYS** panel from **VIEWS** menu                      | **PATHWAYS** panel is displayed first at the right side in the additional panels and consists of the following elements: <li>  **Search keyword**(mandatory) - empty field <li> **SEARCH** button - disabled by default <li>"**Type keyword to start search.**" phrase displays in the panel                                                                                                                                                                                                                                                                                                                                        |
| 5     | Enter **BRCA1** into **Search keyword** field                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 6     | Click **SEARCH** button                                          | A table with corresponding search results are displayed in the PATHWAYS panel:<br/> - **Map** (*hyperlink, sortable*) - map name <br/> - **Description** - map description <br/> - **Source** - map source  <br><br> Search results are displayed in the table: <br> <table><tr><th>Map</th><th>Description</th><th>Source</th><tr><td>BRCA1</td><td>BRCA1 test</td><td>Custom</td></tr></table>                                                                                                                                                                                                                                    |
| 7     | Click on the **BRCA1** hyperlink in the **Map** column           | The new form with map details is opened in the same window instead previous list and contains from: <br><br><li> **<** (**Return**) - button to return to the previous table (with all found maps) displays at the top of sub-tab <li> **Map name label** (*BRCA1*)  - displays to the right of **Return** button  <li> **i** (**Info**) - label near the map name (by navigate this button a tooltip appears with the full map description)  <li>*Additional capabilities section* displays below map label:<br> - **Search** field (*empty by default*)<br>  - **Loupe** button <br> - **Annotation** button</ul> <li>*Map* image |                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 8     | Click **Annotation** button                                      | **Add annotation** modal window is opened with following values inside: <li> **Annotation name** - text input field for specifying annotation name (optional) <li> **Select heatmap file** checkbox - *to load heatmap file registered in NGB*  <li> **Select VCF file** checkbox - *to load variation file registered in NGB (disabled by default)* <li> **Upload TSV/CSV** checkbox - *to load annotation file from the local workstation (in TSV/CSV format)* <li> **Manual colors config** checkbox - *for specifying annotation in plain text format* <br><br> <li>**Apply** button - disabled by default <li> **Cancel** button |                                                                                                   | 
| 9     | Set checkbox in **Select heatmap file** field                    | <li> New empty dropdown field *(mandatory)* is displayed below checkbox <li> 2 pathway objects display below dropdown field: <br/> - **in first column** checkbox (set by default) <br/>  - **first row** checkbox<li> **Annotation name** field is empty <li> **Apply** button is disabled                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 10    | Select **pathway-annotation3** in dropdown field                 | <li> Annotation name field is automatically filled by selected file name = **pathway-annotation3**<li> The following values displays below **Pathway objects** field: <li> Type = Continuous <li> Block of the colors settings: High, Middle, Low, Missing data  <li> **Apply** button is enabled                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 11    | Click **Apply** button                                           | <li>**Add annotation** modal window is closed <li> Saved annotation is appeared in the new **Annotations** pop-up window <li> Annotation name displays as hyperlink  <li> Checkbox displays near the annotation name - *to enable (apply) it or disable* <li> The checkbox is set automatically <li> Remove button displays near the annotation name - *to remove the annotation from the list*                                                                                                                                                                                                                                     |
| 12    | Look at the map                                                  | 3 colors is configured - for minimum value (from all matrix), for maximum value (from all matrix) and middle value (average between minimum and maximum). <li>Colors for all other values in matrix are selected from a gradient according to these three: <br> <table><tr><th>Node name</th><th>Node color</th><tr><td>Tetm</td><td>yellow\red</td><tr><td>Tetp</td><td>green\red</td><tr><td>Laclp</td><td>green</td></tr><tr><td>Laclm</td><td>light-green</td><tr><td>Clp</td><td>green</td></table> <li> All other nodes are not colored                                                                                       |
| 13    | Click **pathway-annotation3** in **Annotations** pop-up          | <li> **Add annotation** modal window is opened                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 14    | Set checkbox in **first row** objects                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 15    | Click **Apply** button                                           | <li>**Add annotation** modal window is closed <li> Saved annotation displays as hyperlink in **Annotations** pop-up window = **pathway-annotation3**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 16    | Look at the map                                                  | 3 colors is configured - for minimum value (from all matrix), for maximum value (from all matrix) and middle value (average between minimum and maximum). <li>Colors for all other values in matrix are selected from a gradient according to these three: <br> <table><tr><th>Node name</th><th>Node color</th><tr><td>Tetm</td><td>yellow\red</td><tr><td>Tetp</td><td>green\red</td></table>                                                                                                                                                                                                                                     |
| 17    | Click **pathway-annotation3** in **Annotations** pop-up          | <li> **Add annotation** modal window is opened                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 18    | Select **Discrete** type and Apply changes                       | <li> For each specific value of the matrix the color is configured (or color(s) for value range(s))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 19    | Look at the map.                                                 | <li>Each pathway object from the matrix colorized in the defined color <li>Defined color(s) for the object is determined from the value corresponding to that object in the matrix and from the defined gradient <li> Only object background color is changed <li>For the object with several values in the matrix: object is colorized in all these colors equally (from left to right in the order as values are specified in matrix)                                                                                                                                                                                             |
