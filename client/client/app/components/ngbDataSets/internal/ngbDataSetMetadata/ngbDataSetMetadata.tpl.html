<md-dialog style="max-height: 75vh;top: 0px">
    <form
        ng-cloak
        name="metadataForm"
        ng-submit="ctrl.saveMetadata()"
    >
        <md-toolbar>
            <div class="md-toolbar-tools">
                <h2>{{ctrl.node.name}}</h2>
                <span flex></span>
                <md-button
                    class="md-icon-button"
                    ng-click="ctrl.closeDialog()"
                >
                  <ng-md-icon icon="close" aria-label="Close dialog"></ng-md-icon>
                </md-button>
              </div>
        </md-toolbar>
        <md-dialog-content>
            <div class="md-dialog-content">
                <div
                    class="dialog-content-inner"
                >
                    <div
                        ng-if="ctrl.metadataIsEmpty"
                        class="message">
                        <h3>This dataset does not contain any attributes.</h3>
                        <h4>Click to the button below to add new one</h4>
                    </div>
                     <h2
                        ng-if="!ctrl.metadataIsEmpty"
                        class="title"
                    >
                        Attributes
                    </h2>
                    <div
                        layout="row"
                        ng-repeat="attr in ctrl.formData"
                        
                    >
                        <md-input-container
                            ng-class="{'hide-excessive-space':ctrl.isDuplicate(ctrl.formData[$index][0]), 'md-block': true}"
                        >
                            <label>Key</label>
                            <input
                                ng-model="ctrl.formData[$index][0]"
                                name="attrKey"
                                required
                                style="width: 250px">
                            <div
                                ng-if="ctrl.isDuplicate(attr[0])"
                                class="warning-container"
                            >
                                <ng-md-icon
                                    icon="warning"
                                    style="fill:orange"
                                    size="12"
                                ></ng-md-icon>
                                <div style="height: 24px">
                                    <span class="warning">Please, enter unique key</span>
                                </div>
                            </div>
                        </md-input-container>
                        <md-input-container class="md-block" class="input-container">
                            <label>Value</label>
                            <input
                                ng-model="ctrl.formData[$index][1]"
                                name="attrValue"
                                required
                                style="width: 250px"
                            >
                        </md-input-container>
                        <md-button class="md-icon-button" ng-click="ctrl.removeAttribute($index)">
                            <ng-md-icon
                                icon="clear"
                                aria-label="add attribute"
                                style="fill: #999999"
                                size="16">
                            </ng-md-icon>
                        </md-button>
                    </div>
                </div>
            </div>
        </md-dialog-content>
        <md-dialog-actions
            layout="row"
            class="layout-row"
            style="padding: 15px;"
        >
            <md-button
                class="md-icon-button"
                ng-click="ctrl.addFormItem()"
                style="height: 48px; width: 48px;"
            >
                <md-tooltip md-direction="top">Add new attribute</md-tooltip>
                <ng-md-icon
                    icon="add_circle_outline"
                    aria-label="add attribute"
                    style="fill: #4285f4"
                    size="32">
                </ng-md-icon>
            </md-button>
            <span flex></span>
            <md-button
                type="submit"
                class="md-primary"
                ng-disabled="!ctrl.metadataIsChanged || ctrl.formHasDuplicates"
            >
              SAVE
              <md-progress-circular ng-show="ctrl.saving" md-mode="indeterminate"></md-progress-circular>
            </md-button>
            <md-button ng-click="ctrl.cancelChanges()">
              CANCEL
            </md-button>
        </md-dialog-actions>
    </form>
</md-dialog>